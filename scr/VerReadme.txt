

V4.22
原因:九江的一些卡的起始日期太大而且大于了终止日期，导致刷卡出现“过期卡”提示。
修改:有效期判断时不判断起始日期，只判断终止日期（九江）。
2012.2.27 KSLi
	2、加入BUS_TGPRS_ 定义，公司密钥｜GPRS－900C
----------------------------------------------------------
V4.23
加大了存贮空间
更改学生卡，消费时按普通卡消费的情况。开了月票区，但没有月票次数，所以转到扣钱时就按普通卡扣了。
－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－
V4.24
	上个版本加大空间后没有清除后面以前没用的区域。
	这个版本清除，加了YYA5,后两位不一致就清除。
------------------------------------------------------------
V4.25
	定死九江ＩＰ地址
-------------------------------------------------------------
V4.26-V4.32
	加入云平台卡消费。
	加入宜春手机卡消费。
	加入兴义。
	修改SAM卡复位应答。
－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－
V4.36
	绍东加入年审，以前没有年审的。需要写死程序里。2012.7.2
-------------------------------------------------------------
V4.37
	修改宜春程序提示要发密钥卡的错误。
-------------------------------------------------------------
V4.38
	固定商户编号为0168。
	修改语音通过线路卡导入时没写入CPU存贮区的BUG。
	发送记录时的CRC16在发送时重新计算。
	添加附加费启用功能（不需要刷空调卡）。
	增加外接调机的传输数据。2012－7－19
	更改邵东家属卡语音为家属卡。（以前是 咚）
	修改九江月票因新的规则加入无效的问题。加入 #define New_Times_Card__ 标志。
	加入宜春在刷司机卡时，要给GPS调度机发送车载机信息。
-------------------------------------------------------------
V4.39
	修改绍东卡，年审日期改到9月1号
	加入没有附加费功能的定义，因为有些地方的附加费标志是开的＝1，但是他们那里又不用附加费功能。
---------------------------------------------------------------
V4.40-V4.42
	修改绍东卡，家属卡语音，他们的家属卡是73...
	加入东龙旧卡结构消费，云平台模式。
	增加卡类71为员工司机卡，可签到、签退，也用于消费（按折扣率）.
	修改亿达卡消费兼容。
-------------------------------------------------------------
V4.43
	历史记录，加入历史每天的首地址。
	商户编号以卡内编号为准，不再取刷卡机内编号。不再提示设置商户编号。
---------------------------------------------------------------
V4.44
	修改宜春司机签到需要按F2或右方向键,5秒之内刷司机卡签到;刷卡机不再进入暂停消费状态。
---------------------------------------------------------------
V4.45
	修改月票附加费，折扣率为101是扣1次再加上月票附加费，110－119再扣0到9次月票附加费。
---------------------------------------------------------------
V4.46
	加入长沙华泰代理公司的程序，银行卡没有用，用调度机传输数据。
---------------------------------------------------------------
V4.47
	邵东PSAM不认。取响应时没有INS返回，应该有返回但是没有收到。。做了个兼容，需要注意。
---------------------------------------------------------------
V4.48
	宜春的统计显示为员工编号而不再是卡号。
	记录中加入设备序列号。
	加入了WIFI_TLH 模块。北京力天宏威
	//WIFI 需要设置的参数：SSID，密码，服务器IP和端口号,无线路由需要可以开启DHCP服务器以便自动获取IP和网关。
	//WIFI 如果不启用DHCP服务器，则还需要有本POS机的IP地址，子网掩码，默认网关。[不使用，因为不可能给每台车载机设不一样的IP地址]
---------------------------------------------------------------
V4.49
	宜春的“请及时充值”语音前面加上个“咚”。
	宜春的所有的语音都支持男声。
	GPS报站距离改小，进站也加入了航向判断。
	加入宝鸡公交应用，红外、PSAM卡。
---------------------------------------------------------------
V4.50
	再次调小GPS报站距离，现在改成5米。
	修改下载黑名单有时到100%时机器重新启动的错误.
---------------------------------------------------------------------
V4.51-V4.56
	GPRS出错时改为关闭电源。只测试GPRS模块，还需要测试CDMA模块[已测]。
	如果没有设置商户编号，默认是9998。
	修改宝鸡的语音及取密钥。
	修改控制卡。
	修改年票月票不足时，先提示了请投币。再去扣钱又提示咚的问题。
	去掉了请投币时的 滴滴滴,宝鸡的卡加入请年审提示.
	宜春的语音，黑名单卡提示改成挂失卡，请交回
	调整GPS自动报站的功能。
	宝石电信卡中在原来咚一声响的情况下加入了M1卡的消费。电信卡还是原来拉煤的那种状态。
---------------------------------------------------------------------
V4.57
	宁德加入GPS数据上传。
---------------------------------------------------------------------
V4.58
	加入了新模具车载机程序应用，需要启用“_New_Bu_mode_”宏定义。并使用“NewBUproject”中的工程编译。
	加入北京考勤功能。
-------------------------------------------------------------------------
V4.59-V4.60
	加入鄂州公交，并修改语音和线路卡刷卡
	修改线路卡和密钥卡通过目录区的定义来访问。
	赤峰加入同一张普通卡连刷限制
	修改有时没有刷卡语音的问题，有些芯片复位不好。
	莱州市安泰电子的卡改为所有的卡都可以连刷.
--------------------------------------------------------------------------
V4.61-V4.62
	修改初始化PSAM卡的一处问题。
	加入进入设置菜单需要刷卡功能，宏定义为：PASSWORD_CARD_
---------------------------------------------------------------------------
V4.63-V4.64
	修改取机器唯一序列号。
	加入分段收费。
	所有的程序加入司机员工编号的显示。
	修改九江需要到站状态刷控制卡。设置信息需要设备设置卡进入，不用菜单进入。
---------------------------------------------------------------------------
V4.65-V4.66
	修改加入邯郸的采集相关功能。32字节记录，采集时有包头和包尾。
	修改一点九江的程序，1、月票扣钱的卡可以连刷，2、需要判断两个PSAM卡座
---------------------------------------------------------------------------
V4.67
	修宜春的扣钱可以连刷。
	修改每次刷卡后从CPU的FLASH中重新读取设备号
---------------------------------------------------------------------------
V4.68-V4.70
	宜宾需要判断商户编号，不一致不让刷卡。
	鄂州的学生卡不能判断有效期。
	分段收费上车时在卡内的全程票价改成到终点站的票价。
	鄂州加入大众卡和校园卡.
---------------------------------------------------------------------------
V4.71
	鄂州不写入卡内黑名单标志
---------------------------------------------------------------------------
V4.72
	济南济南弘顺金宇科技有限公司 加入刷卡人数限制【#define _Counter_SWcard_times】，刷卡人数最高限制可以设置。
	修改取线路的的语音设置问题。
	华泰的加入了串口继电器的控制。
---------------------------------------------------------------------------
V4.73-V4.74
	长清公司的优惠卡及优待卡需要连刷。
	改名称及开机语音。
----------------------------------------------------------------------------
V4.75
	加入变量xfSounding。当语音播报时，关闭射频天线。
	九江的学生卡有些可以连刷。改正
-----------------------------------------------------------------------------
V4.76
	当语音播报完成后，射频天线打开快了点，还有一点点噪音，延时了一会才打开。
	
-----------------------------------------------------------------------------
V4.77-V4.78
	修水：报出站时 只取线路号第一个字节。
-----------------------------------------------------------------------------
V4.79
	修水：普通卡【所有卡】都不能连刷，68号卡名称显示改为“联名卡”，开机语音中的IC去掉。
	采集数据时，把设备号的第9位写成‘0’，避免乱码。
	更改检测电压低后，不在中断内死等。在主循环内处理。
-----------------------------------------------------------------------------
V1.01
	因531会损坏(主要是因为车内电压有时太低，导致531损坏)，所以版本更换，对于之前版本改动如下。
	1、不能频繁开启关闭531天线。
	2、低电压检测还是需要放在中断内，并在恢复电压时自动重启。
	3、刷卡时不发送数据。
----------------------------------------------------------------------------------
V1.02 - V1.03
	九江的 10号卡【CPU】老是不能连刷，是他们折扣率没有设置，设置成了202。现在在程序里写死，10号卡类使用0卡类的折扣率。
	修改月票消费，请重刷时没有调用“CheckSno(ERROR_MONTH,OPER_TRANSFER_NO,buffer);”
V1.04-V1.05
	宜春的老卡也受折扣率影响。
----------------------------------------------------------------------------------
V1.06
	黎川的学生卡改成连刷。
	中科讯联，奎屯的卡加入恒宝的手机卡、和其它的卡有点不太一样。
	设备号00000001现在也认为是正确的。
	加入检测IP是错误的，则自动设置成默认值。
----------------------------------------------------------------------------------
V1.07-V1.08
	修正检测电压。
	去掉了公共信息和记录区。
	兴义公交加入银联卡消费。
----------------------------------------------------------------------------------
V1.09
	兴义加了银联卡后PSAM密钥算法出错了，更改。
	英山程序加入月统计。
----------------------------------------------------------------------------------
V1.10
	因为兴义银联卡需要不同的折扣，加入了银联卡卡类：#define CARD_qPBOC_BUS 0x5B	//91
	因为兴义要后台控制银联卡启用禁用，加入了启用标志：#define Center_Ctrl_BU_ENABEL
	东乡普通卡要报 “普通卡”
	黎川县公共交通公司 “请充值”提示希望改成消费票价的四倍
	加入下载车载机参数据指令 4005.后面都支持此功能。
--------------------------------------------------------------------------------------
V1.11
	修正历史记录采集的BUG。并把相应的函数移动到PROLIB中。
--------------------------------------------------------------------------------------
V1.12
	兴义程序，把卡处理时关闭天线的再次去掉。
	并且，库函数里的询卡函数“GetTypeAUID”中的SetRfMode( 0 );去掉，不用每次都去设置一次寄存器
---------------------------------------------------------------------------------------
V1.14
	英文去掉写黑卡，和判断卡内有效期。
	银联卡加入了“请重刷”机制。
---------------------------------------------------------------------------------------
Ver:1.15
	银联卡加入了请重刷机制,重刷后，很多域数据被改变，重刷时生成记录。
	增加0078商户的程序。
-------------------------------------------